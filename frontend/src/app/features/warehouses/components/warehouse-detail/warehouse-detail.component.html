<div class="p-4">
  @if (loading()) {
    <div class="flex flex-col gap-4">
      <div class="h-8 w-48 animate-pulse rounded bg-gray-200"></div>
      <div class="h-24 animate-pulse rounded bg-gray-200"></div>
      <div class="h-64 animate-pulse rounded bg-gray-200"></div>
    </div>
  } @else {
    <!-- Breadcrumb -->
    <nav class="mb-4 text-sm !text-gray-500">
      <span>{{ 'WAREHOUSE.TITLE' | translate }}</span>
      <span class="mx-2">&gt;</span>
      <span class="font-medium !text-gray-800">{{ warehouse()?.name }}</span>
    </nav>

    <!-- Header -->
    <div class="mb-6 flex items-start justify-between">
      <div>
        <h1 class="text-2xl font-bold !text-gray-600">{{ warehouse()?.name }}</h1>
        <div class="flex items-center text-gray-600 gap-1">
          <i class="pi pi-map-marker"></i>
          <p class="m-0">{{ warehouse()?.location }}</p>
        </div>
        @if (warehouse()?.description) {
          <p class="mt-1 text-gray-500">{{ warehouse()?.description }}</p>
        }
      </div>
      <div class="flex gap-2">
        <p-button
          [label]="'WAREHOUSE.BACK_BUTTON' | translate"
          icon="pi pi-arrow-left"
          severity="secondary"
          (onClick)="goBack()"
        />
      </div>
    </div>

    <!-- Stats -->
    <div class="mb-6 grid grid-cols-3 gap-4">
      <div class="rounded border bg-blue-50 p-4 text-center shadow-sm">
        <div class="text-2xl font-bold text-blue-600">{{ products().length }}</div>
        <div class="text-sm text-gray-500">{{ 'WAREHOUSE.TOTAL_PRODUCTS' | translate }}</div>
      </div>

      <div class="rounded border p-4 text-center shadow-sm"
           [class]="lowStockCount() > 0 ? 'bg-red-50 border-red-200' : 'bg-gray-50 border-gray-200'">
        <div [class]="lowStockCount() > 0 ? 'text-red-600 text-2xl font-bold' : 'text-gray-700 text-2xl font-bold'">
          {{ lowStockCount() }}
        </div>
        <div class="text-sm text-gray-500">{{ 'WAREHOUSE.LOW_STOCK_COUNT' | translate }}</div>
      </div>

      <div class="rounded border bg-green-50 p-4 text-center shadow-sm">
        <div class="text-2xl font-bold text-green-600">{{ totalUnits() }}</div>
        <div class="text-sm text-gray-500">{{ 'WAREHOUSE.TOTAL_UNITS' | translate }}</div>
      </div>
    </div>

    <!-- Products section -->
    <div class="mb-4 flex items-center justify-between">
      <h2 class="text-xl font-semibold !text-gray-500">{{ 'PRODUCT.LIST_TITLE' | translate }}</h2>
    </div>

    <!-- ProductList component -->
    <app-product-list
      [products]="products()"
      [warehouseId]="warehouseId()"
      (edit)="openEditProduct($event)"
      (delete)="confirmDeleteProduct($event)"
      (add)="openAddProduct()"
    />
  }
</div>

<app-product-form
  [visible]="showProductForm()"
  (visibleChange)="showProductForm.set($event)"
  [product]="selectedProduct()"
  [warehouseId]="warehouseId()"
  (saved)="onProductSaved()"
/>
<p-confirmDialog />
